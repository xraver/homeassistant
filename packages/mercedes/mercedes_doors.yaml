######################################################################
# Mercedes Package - Doors Sensors
######################################################################

template:

  ######################################################################
  # Binary Sensor: Doors Lock
  #
  # ff590mr_lock:
  # 0 -> unlocked
  # 1 -> internal locked (e.g. driving)
  # 2 -> external locked (e.g. locked by key)
  ######################################################################
  - binary_sensor:
        - name: ff590mr_locked"
          unique_id: ff590mr_locked
          state: >
            {% if is_state('sensor.ff590mr_lock', '0') %}
              on
            {% else %}
              off
            {% endif %}
          device_class: door   # oppure safety, connectivity, problem… lock non è supportato
          icon: >
            {% if not is_state('sensor.ff590mr_lock', '0') %}
              mdi:lock
            {% else %}
              mdi:lock-open
            {% endif %}

  ######################################################################
  # Binary Sensor: Doors Closed
  #
  # doorStatusOverall:
  #   1 -> closed
  #   0 -> opened
  ######################################################################
  - binary_sensor:
      - name: "ff590mr_doors_closed"
        unique_id: ff590mr_doors_closed
        state: "{{ is_state_attr('sensor.ff590mr_lock', 'doorStatusOverall', '0') }}"
        device_class: opening
        icon: >
          {% if is_state('sensor.ff590mr_lock', '2') %}
            mdi:car-door-lock
          {% elif is_state_attr('sensor.ff590mr_lock', 'doorStatusOverall', '1') %}
            mdi:car-door
          {% else %}
            mdi:car-door
          {% endif %}

  ######################################################################
  # Binary Sensor: Door Front Left
  ######################################################################
  - binary_sensor:
      - name: "ff590mr_door_front_left"
        unique_id: ff590mr_door_front_left
        state: "{{ is_state_attr('sensor.ff590mr_lock', 'doorstatusfrontleft', true) }}"
        device_class: opening
        icon: >
          {% if is_state('sensor.ff590mr_lock', '2') %}
            mdi:car-door-lock
          {% elif not is_state_attr('sensor.ff590mr_lock', 'doorstatusfrontleft', true) %}
            mdi:car-door
          {% else %}
            mdi:car-door
          {% endif %}

  ######################################################################
  # Binary Sensor: Door Front Right
  ######################################################################
  - binary_sensor:
      - name: "ff590mr_door_front_right"
        unique_id: ff590mr_door_front_right
        state: "{{ is_state_attr('sensor.ff590mr_lock', 'doorstatusfrontright', true) }}"
        device_class: opening
        icon: >
          {% if is_state('sensor.ff590mr_lock', '2') %}
            mdi:car-door-lock
          {% elif not is_state_attr('sensor.ff590mr_lock', 'doorstatusfrontright', true) %}
            mdi:car-door
          {% else %}
            mdi:car-door
          {% endif %}

  ######################################################################
  # Binary Sensor: Door Rear Left
  ######################################################################
  - binary_sensor:
      - name: "ff590mr_door_rear_left"
        unique_id: ff590mr_door_rear_left
        state: "{{ is_state_attr('sensor.ff590mr_lock', 'doorstatusrearleft', true) }}"
        device_class: opening
        icon: >
          {% if is_state('sensor.ff590mr_lock', '2') %}
            mdi:car-door-lock
          {% elif not is_state_attr('sensor.ff590mr_lock', 'doorstatusrearleft', true) %}
            mdi:car-door
          {% else %}
            mdi:car-door
          {% endif %}

  ######################################################################
  # Binary Sensor: Door Rear Right
  ######################################################################
  - binary_sensor:
      - name: "ff590mr_door_rear_right"
        unique_id: ff590mr_door_rear_right
        state: "{{ is_state_attr('sensor.ff590mr_lock', 'doorstatusrearright', true) }}"
        device_class: opening
        icon: >
          {% if is_state('sensor.ff590mr_lock', '2') %}
            mdi:car-door-lock
          {% elif not is_state_attr('sensor.ff590mr_lock', 'doorstatusrearright', true) %}
            mdi:car-door
          {% else %}
            mdi:car-door
          {% endif %}

  ######################################################################
  # Binary Sensor: Decklid
  ######################################################################
  - binary_sensor:
      - name: "ff590mr_decklid"
        unique_id: ff590mr_decklid
        state: "{{ is_state_attr('sensor.ff590mr_lock', 'decklidstatus', true) }}"
        device_class: opening
        icon: >
          {% if is_state('sensor.ff590mr_lock', '2') %}
            mdi:car-door-lock
          {% elif not is_state_attr('sensor.ff590mr_lock', 'decklidstatus', true) %}
            mdi:car-door
          {% else %}
            mdi:car-door
          {% endif %}
