######################################################################
# Shelly Package - Operations Script
######################################################################

script:
  ######################################################################
  # Shelly: Upgrade
  ######################################################################
  shelly_upgrade:
    alias: "Shelly: Aggiornamento Firmware Collettivo"
    sequence:
    #  - service: mqtt.publish
    #    data:
    #      topic: 'shellies/command'
    #      payload: 'update_fw'
    #      qos: 0
    #      retain: false
      - service: update.install
        target:
          entity_id:
            - group.shelly

  ######################################################################
  # Shelly: Reboot
  ######################################################################
  shelly_reboot:
    alias: "Shelly: Riavvio Dispositivi Collettivo"
    sequence:
      - service: shell_command.shelly_reboot

######################################################################
# Shelly Package - Operations Shell Command
######################################################################
shell_command:
  shelly_reboot: 'bash /config/shell_scripts/shelly_reboot.sh'
